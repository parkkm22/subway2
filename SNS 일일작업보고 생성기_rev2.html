<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#667eea" />
    <meta name="description" content="ë°œì£¼ì²˜ ë³´ê³ ìš© í…ìŠ¤íŠ¸ ìƒì„± ëª¨ë°”ì¼ ì•±" />
    <title>ğŸ“‹ ê³µì‚¬ì¼ë³´ ìƒì„±ê¸°</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; overscroll-behavior-y: contain; }
        .app { min-height: 100vh; display: flex; flex-direction: column; }
        .app-header { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 20px; text-align: center; box-shadow: 0 2px 20px rgba(0,0,0,0.1); border-bottom: 1px solid rgba(255,255,255,0.2); }
        .app-header h1 { color: #333; font-size: 24px; font-weight: 700; margin-bottom: 8px; }
        .app-header p { color: #555; font-size: 14px; margin: 0; }
        .app-main { flex: 1; padding: 20px; max-width: 600px; margin: 0 auto; width: 100%; }
        .input-section { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 20px; padding: 24px; margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); }
        .input-group { margin-bottom: 20px; }
        .input-group:last-of-type { margin-bottom: 24px; }
        .input-group label { display: block; font-weight: 600; color: #333; margin-bottom: 8px; font-size: 16px; }
        .input-group textarea { width: 100%; padding: 16px; border: 2px solid #e1e5e9; border-radius: 12px; font-size: 16px; line-height: 1.5; resize: vertical; transition: all 0.3s ease; font-family: inherit; background: #fafafa; }
        #projectInfo { min-height: 144px; } /* 6 rows * 1.5 line-height * 16px font-size */
        #todayWork { min-height: 192px; } /* 8 rows * 1.5 line-height * 16px font-size */
        #issuesAndSolutions { min-height: 144px; } /* 6 rows * 1.5 line-height * 16px font-size */
        .input-group textarea:focus { outline: none; border-color: #667eea; background: white; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
        .input-group textarea::placeholder { color: #777; }
        .button-group { display: flex; gap: 12px; margin-top: 24px; }
        .generate-btn, .clear-btn { flex: 1; padding: 16px 24px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-align: center; }
        .generate-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .generate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102,126,234,0.3); }
        .generate-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .clear-btn { background: #f8f9fa; color: #666; border: 2px solid #e1e5e9; }
        .clear-btn:hover { background: #e9ecef; border-color: #ced4da; transform: translateY(-1px); }
        .clear-btn:active {
            transform: scale(0.97);
            transition: transform 0.1s ease;
        }
        .prompt-btn {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e1e5e9;
        }
        .prompt-btn:hover {
            background: #e9ecef;
            border-color: #ced4da;
        }
        .prompt-btn:active {
            transform: scale(0.97);
            transition: transform 0.1s ease;
        }
        .output-section { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 20px; padding: 24px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); animation: fadeInUp 0.5s ease; display: none; }
        .output-section.show { display: block; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .output-section h2 { color: #333; font-size: 20px; margin-bottom: 16px; font-weight: 700; }
        .report-output { background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 4px solid #667eea; overflow-x: auto; }
        .report-output pre { margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: inherit; font-size: 14px; line-height: 1.6; color: #333; }
        .share-buttons { display: flex; gap: 12px; flex-wrap: wrap; }
        .share-btn, .copy-btn, .edit-btn {
            flex: 1; padding: 14px 20px; border: none; border-radius: 12px;
            font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            min-width: calc(33.333% - 8px);
        }
        .share-btn {
            background: #FEE500; /* ì¹´ì¹´ì˜¤í†¡ ë…¸ë€ìƒ‰ */
            color: #191919; /* ëŒ€ë¹„ë¥¼ ìœ„í•œ ì–´ë‘ìš´ ê¸€ììƒ‰ */
        }
        .share-btn:hover {
            background: #FADA0A; /* í˜¸ë²„ ì‹œ ì•½ê°„ ì–´ë‘¡ê²Œ */
            box-shadow: 0 6px 20px rgba(254,229,0,0.4);
        }
        .copy-btn { background: #f8f9fa; color: #666; border: 2px solid #e1e5e9; }
        .copy-btn:hover { background: #e9ecef; border-color: #ced4da; transform: translateY(-1px); }
        .edit-btn {
            background: #6c757d; /* ë¶€íŠ¸ìŠ¤íŠ¸ë© secondary ëŠë‚Œ */
            color: white;
        }
        .edit-btn:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }
        .app-footer { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); padding: 16px; text-align: center; border-top: 1px solid rgba(255,255,255,0.2); }
        .app-footer p { color: rgba(255,255,255,0.8); font-size: 12px; margin: 0; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        @media (max-width: 480px) { .app-header { padding: 16px; } .app-header h1 { font-size: 20px; } .app-main { padding: 16px; } .input-section, .output-section { padding: 20px; border-radius: 16px; } .button-group, .share-buttons { flex-direction: column; } .generate-btn, .clear-btn, .share-btn, .copy-btn { width: 100%; margin-bottom: 8px; } .input-group textarea { font-size: 16px; } }
        @media (hover: none) and (pointer: coarse) { .generate-btn:hover:not(:disabled), .clear-btn:hover, .share-btn:hover, .copy-btn:hover { transform: none; } .generate-btn:active:not(:disabled) { transform: scale(0.98); } .clear-btn:active, .share-btn:active, .copy-btn:active { transform: scale(0.98); } }
        .bottom-buttons {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            display: flex;
            gap: 2px; /* 4pxì—ì„œ 2pxë¡œ ìˆ˜ì • */
            padding: 16px 12px 20px 12px;
            box-shadow: 0 -2px 20px rgba(0,0,0,0.07);
            z-index: 100;
        }
        .bottom-buttons button {
            flex: 1;
            font-size: 15px;
            font-weight: 600;
            border-radius: 12px;
            border: none;
            padding: 14px 5px; /* 14px 0ì—ì„œ 14px 5pxë¡œ ìˆ˜ì • */
            cursor: pointer;
            transition: all 0.2s;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.3);
            justify-content: center;
            align-items: center;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background: #fff;
            border-radius: 16px;
            padding: 24px;
            max-width: 600px;
            width: 90vw;
            box-shadow: 0 8px 32px rgba(0,0,0,0.18);
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .modal-content h3 {
            margin: 0 0 8px 0;
            font-size: 18px;
            font-weight: 700;
        }
        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        .modal-actions button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
        }
        #promptSaveBtn { background: #667eea; color: #fff; }
        #promptCancelBtn { background: #f8f9fa; color: #333; border: 1px solid #e1e5e9; }
        @media (max-width: 480px) {
            .modal-content { padding: 12px; }
            .modal-content h3 { font-size: 16px; }
        }
        /* ë³´ê³ ì„œ í¸ì§‘ìš© textarea ìŠ¤íƒ€ì¼ */
        .report-edit-area {
            width: 100%;
            min-height: 900px; /* ë§¤ìš° í¬ê²Œ ì¡°ì • */
            padding: 16px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 14px; /* pre íƒœê·¸ì™€ ë™ì¼í•˜ê²Œ */
            line-height: 1.6; /* pre íƒœê·¸ì™€ ë™ì¼í•˜ê²Œ */
            font-family: inherit; /* pre íƒœê·¸ì™€ ë™ì¼í•˜ê²Œ */
            resize: vertical;
            margin-bottom: 12px;
        }
        /* QA Log Card ìŠ¤íƒ€ì¼ */
        .qa-log-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(8px);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px; /* ìœ„ ìš”ì†Œì™€ì˜ ê°„ê²© */
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.15);
        }
        .qa-log-card h3 {
            color: #333;
            font-size: 18px;
            margin-bottom: 12px;
            font-weight: 700;
        }
        .qa-log-card pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 300px; /* ë„ˆë¬´ ê¸¸ì–´ì§€ëŠ” ê²ƒì„ ë°©ì§€ */
            overflow-y: auto;
            background: #f0f2f5;
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            color: #444;
            border: 1px solid #e1e5e9;
        }
        /* QA Log Card í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .qa-log-card h4 { /* USER TEXT N ë³€ê²½ì‚¬í•­: ë¶€ë¶„ ìŠ¤íƒ€ì¼ */
            margin-top: 15px;
            margin-bottom: 8px;
            font-size: 15px;
            color: #444;
        }
        .qa-log-card h4:first-of-type {
            margin-top: 0;
        }
        .qa-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        .qa-table th, .qa-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-break: break-all;
        }
        .qa-table th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        .qa-table tbody tr:nth-child(odd) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="app-header">
            <h1>âœ¨SNS ì¼ì¼ì‘ì—…ë³´ê³  ìƒì„±ê¸°</h1>
            <p>í˜‘ë ¥ì‚¬ ë‚´ìš© ì·¨í•©ë¶€í„° ë°œì£¼ì²˜ ì–‘ì‹ìœ¼ë¡œ ì •ë¦¬ê¹Œì§€ í•œ ë²ˆì—</p>
        </header>
        <main class="app-main">
            <div class="input-section">
                <div class="input-group">
                    <label for="projectInfo">A í˜‘ë ¥ì‚¬</label>
                    <textarea id="projectInfo" placeholder="í˜‘ë ¥ì‚¬ë³„ ì‘ì—…ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="6"></textarea>
                </div>
                <div class="input-group">
                    <label for="todayWork">B í˜‘ë ¥ì‚¬</label>
                    <textarea id="todayWork" placeholder="í˜‘ë ¥ì‚¬ë³„ ì‘ì—…ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="8"></textarea>
                </div>
                <div class="input-group">
                    <label for="issuesAndSolutions">C í˜‘ë ¥ì‚¬</label>
                    <textarea id="issuesAndSolutions" placeholder="í˜‘ë ¥ì‚¬ë³„ ì‘ì—…ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="6"></textarea>
                </div>
            </div>
            <div class="output-section" id="outputSection">
                <h2>ğŸ“‹ ìƒì„±ëœ ë³´ê³ ì„œ</h2>
                <div class="report-output">
                    <pre id="reportContent"></pre>
                    <textarea id="reportEditArea" class="report-edit-area" style="display:none;"></textarea>
                </div>
                <div class="share-buttons">
                    <button class="share-btn" id="shareBtn">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
                    <button class="copy-btn" id="copyBtn">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
                    <button class="edit-btn" id="editReportBtn">âœï¸ ìˆ˜ì •í•˜ê¸°</button>
                    <button class="edit-btn" id="saveChangesBtn" style="display:none; background-color: #28a745;">ğŸ’¾ ì €ì¥</button>
                    <button class="edit-btn" id="cancelEditBtn" style="display:none; background-color: #dc3545;">âŒ ì·¨ì†Œ</button>
                </div>
                <div id="qaLogCard" class="qa-log-card" style="display:none;">
                    <h3>ğŸ“Š ë³€ê²½ì‚¬í•­</h3>
                    <pre id="qaLogContentAreaCard"></pre>
                </div>
            </div>
        </main>
        <div class="bottom-buttons">
            <button class="generate-btn" id="generateBtn">ğŸ“„ ë³´ê³ ì„œ ìƒì„±</button>
            <button class="clear-btn" id="clearBtn">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
            <button class="prompt-btn" id="promptEditBtn">âš™ï¸ í”„ë¡¬í”„íŠ¸</button>
        </div>
        <div id="promptModal" class="modal">
            <div class="modal-content">
                <h3>í”„ë¡¬í”„íŠ¸(ì§€ì‹œë¬¸) ìˆ˜ì •</h3>
                <textarea id="promptEditArea" rows="16" style="width:100%;font-size:13px;"></textarea>
                <div class="modal-actions">
                    <button id="promptSaveBtn">ì €ì¥</button>
                    <button id="promptCancelBtn">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>
        <footer class="app-footer">
            <p>Â© 2024 ê³µì‚¬ì¼ë³´ ìƒì„±ê¸° - í˜„ì¥ ì—…ë¬´ íš¨ìœ¨í™”</p>
        </footer>
    </div>
    <script>
        const projectInfo = document.getElementById('projectInfo');
        const todayWork = document.getElementById('todayWork');
        const issuesAndSolutions = document.getElementById('issuesAndSolutions');
        const generateBtn = document.getElementById('generateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const outputSection = document.getElementById('outputSection');
        const reportContent = document.getElementById('reportContent');
        const shareBtn = document.getElementById('shareBtn');
        const copyBtn = document.getElementById('copyBtn');
        const editReportBtn = document.getElementById('editReportBtn');
        const reportEditArea = document.getElementById('reportEditArea');
        const saveChangesBtn = document.getElementById('saveChangesBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const qaLogCard = document.getElementById('qaLogCard');
        const qaLogContentAreaCard = document.getElementById('qaLogContentAreaCard');
        let generatedReport = '';
        let qaChecklistContent = '';
        let PROMPT = '# INSTRUCTIONS\n' +
            '1. ì¶œë ¥ì€ ì½”ë“œë¸”ëŸ­ìœ¼ë¡œ ê°ì‹¸ê³ , "MAIN SET" ì–‘ì‹ì„ ìœ ì§€í•˜ì—¬ ì‘ì„±í•  ê²ƒ\n' +
            '2. ì…ë ¥ëœ USER TEXT 3ê°œ í•­ëª©ì„ ê¸°ë°˜ìœ¼ë¡œ "MAIN SET"ì˜ ê° ìœ„ì¹˜ì— ë§ëŠ” ë‚´ìš©ë§Œ ì±„ì›Œì„œ í•˜ë‚˜ì˜ ë³´ê³ ì„œë¡œ ì·¨í•©í•  ê²ƒ\n' +
            '3. ì‘ì—… ìœ„ì¹˜ëŠ” ì•„ë˜ ìˆœì„œì— ë”°ë¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³ , ìˆ«ì ë²ˆí˜¸(ì˜ˆ: 1), 2))ë¡œ êµ¬ë¶„ëœ ì„¹ì…˜ì€ ì„œë¡œ ì™„ì „íˆ ë…ë¦½ëœ ë‚´ìš©ìœ¼ë¡œ ì·¨ê¸‰ \n' +
            '   - 1. ë³¸ì„ í„°ë„(1êµ¬ê°„)\n' +
            '   - 2. ì‹ í’ì •ê±°ì¥\n' +
            '   - 3. ì‹ í’ì •ê±°ì¥ í™˜ìŠ¹í†µë¡œ\n' +
            '   - 4. ë³¸ì„ í„°ë„(2êµ¬ê°„)\n' +
            '   - 5. ë„ë¦¼ì‚¬ê±°ë¦¬ì •ê±°ì¥\n' +
            '4. ë‚ ì§œëŠ” USER TEXTì— ëª…ì‹œëœ ë‚ ì§œ ì¤‘ ì²« ë²ˆì§¸ í•­ëª© ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±\n' +
            '5. "â€» ì•ˆì „ê´€ë¦¬ ì¤‘ì  POINT"ëŠ” ì¤‘ë³µ ì—†ì´ ìµœëŒ€ 10ê°œ ì´í•˜ë§Œ ì¶”ì¶œí•˜ì—¬ ë§¨ í•˜ë‹¨ì— 1íšŒë§Œ ì‘ì„±\n' +
            '6. "â–  ì´ ì¸ì›" ë° "â–  ì´ ì¥ë¹„" í•­ëª©ì€ ì „ì²´ íˆ¬ì…ì¸ì› ë° ì¥ë¹„ë¥¼ ë‹¨ìˆœ í•©ì‚°í•˜ì—¬ ì‘ì„±í•˜ë©°, ìœ„ì¹˜ë³„ ê³µì¢… êµ¬ë¶„ ì—†ì´ ì „ì²´ ìˆ˜ëŸ‰ë§Œ ì‘ì„±\n' +
            '7. QA-CHECKLIST(ìë™ ê²€ì¦ í›„ ë³€í™˜ë¡œê·¸ ì¶œë ¥)\n' +
            '- ì ˆëŒ€ ì¤‘ìš”: ì•„ë˜ Mapping Rulesì˜ ì˜ˆì‹œëŠ” ë³€ê²½ì‚¬í•­ì— í¬í•¨í•˜ì§€ ë§ ê²ƒ\n' +
            '- USER TEXTì— ì‹¤ì œë¡œ ì¡´ì¬í•˜ê³  ì‹¤ì œë¡œ ë³€ê²½ëœ ë‹¨ì–´ë§Œ ê¸°ë¡\n' +
            '- "ë¤í”„íŠ¸ëŸ­ 2ëŒ€", "B/H08W", "ì¹´ê³ í¬ë ˆì¸ 5T" ë“±ì€ ì˜ˆì‹œì´ë¯€ë¡œ ì›ë¬¸ì— ì—†ìœ¼ë©´ ì ˆëŒ€ ê¸°ë¡í•˜ì§€ ë§ ê²ƒ\n' +
            '- ë³€ê²½ ì „í›„ë¥¼ ì •í™•íˆ ë¹„êµí•˜ì—¬ ì‹¤ì œ ë³€ê²½ëœ ë‚´ìš©ë§Œ ê¸°ë¡\n' +
            '- ì›ë¬¸ì— ì—†ëŠ” ë‹¨ì–´ëŠ” ì ˆëŒ€ ë³€ê²½ì‚¬í•­ì— í¬í•¨í•˜ì§€ ë§ ê²ƒ\n' +
            '- ë³€ê²½ëœ ê²ƒì´ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ë°˜ë“œì‹œ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì¶œë ¥:\n' +
            '  USER TEXT 1 ë³€ê²½ì‚¬í•­:\n' +
            '  | ì›ë¬¸ | ê²°ê³¼ |\n' +
            '  |---|---|\n' +
            '  | [ì‹¤ì œë³€ê²½ëœì›ë¬¸] | [ì‹¤ì œë³€ê²½ëœê²°ê³¼] |\n\n' +
            '  USER TEXT 2 ë³€ê²½ì‚¬í•­:\n' +
            '  | ì›ë¬¸ | ê²°ê³¼ |\n' +
            '  |---|---|\n' +
            '  | [ì‹¤ì œë³€ê²½ëœì›ë¬¸] | [ì‹¤ì œë³€ê²½ëœê²°ê³¼] |\n\n' +
            '  USER TEXT 3 ë³€ê²½ì‚¬í•­:\n' +
            '  | ì›ë¬¸ | ê²°ê³¼ |\n' +
            '  |---|---|\n' +
            '  | [ì‹¤ì œë³€ê²½ëœì›ë¬¸] | [ì‹¤ì œë³€ê²½ëœê²°ê³¼] |\n\n' +
            '- íŠ¹ì • USER TEXTì—ì„œ ë³€ê²½ì‚¬í•­ì´ ì—†ìœ¼ë©´ í•´ë‹¹ ì„¹ì…˜ì— "ë³€ê²½ì‚¬í•­ ì—†ìŒ" í‘œê¸°\n' +
            '- ëª¨ë“  USER TEXTì—ì„œ ë³€ê²½ì‚¬í•­ì´ ì—†ì„ ë•Œë§Œ: "ëª¨ë“  USER TEXTì—ì„œ ë³€ê²½ì‚¬í•­ ì—†ìŒ"\n\n' +
            '# Mapping Rules\n' +
            '1. ì¸ì› \n' +
            '- í‘œê¸° ìˆœì„œ: â‘ ì§ì˜ë°˜ì¥ â†’ â‘¡ëª©ê³µ â†’ â‘¢ì² ê·¼ê³µ â†’ â‘£ì—°ìˆ˜ìƒ â†’ â‘¤ì‹ í˜¸ìˆ˜ â†’ â‘¥ê·¸ ì™¸\n' +
            '- "ì§ì˜"ì€ ì—°ìˆ˜ìƒì— í•©ì‚° (ë‹¨, ì§ì˜ë°˜ì¥ì€ ë³„ë„ í‘œê¸°)\n' +
            '- "0ëª…", "-ëª…" ë“±ì€ ì œì™¸í•˜ê³ , ì¸ì› í•­ëª©ì´ ì—†ì„ ê²½ìš° "ì—†ìŒ"ìœ¼ë¡œ í‘œê¸°\n' +
            '- ì¸ì›ì€ ìŠ¬ë˜ì‹œ(/)ë¡œ êµ¬ë¶„\n' +
            '- \'/ ì•ë’¤ì— ê³µë°±ì´ ìˆë“  ì—†ë“  ë¬´ê´€í•˜ë©°, ë‘˜ ë‹¤ ì •ìƒì ìœ¼ë¡œ ì¸ì‹ ë° í•©ì‚°ë¨\'\n' +
            '-"ì§ì˜"ì€ ì—°ìˆ˜ìƒì— í¬í•¨í•˜ì—¬ ê³„ì‚°\n' +
            '2. ì¥ë¹„\n' +
            '- ""0ëŒ€", "-ëŒ€" ë“±ì€ ì œì™¸í•˜ê³ , ì¥ë¹„ í•­ëª©ì´ ì—†ì„ ê²½ìš° "ì—†ìŒ"ìœ¼ë¡œ í‘œê¸°\n' +
            '- ë„ì–´ì“°ê¸°, ëŒ€ì†Œë¬¸ì, ê´„í˜¸ ë“± ì˜¤íƒ€ ê°€ëŠ¥ì„±ì„ ê°ì•ˆí•˜ì—¬ ë§¤í•‘\n' +
            '- ì¥ë¹„ëŠ” ìŠ¬ë˜ì‹œ(/)ë¡œ êµ¬ë¶„\n' +
            '- \'/ ì•ë’¤ì— ê³µë°±ì´ ìˆë“  ì—†ë“  ë¬´ê´€í•˜ë©°, ë‘˜ ë‹¤ ì •ìƒì ìœ¼ë¡œ ì¸ì‹ ë° í•©ì‚°ë¨\'\n' +
            '3. â€» ì•ˆì „ê´€ë¦¬ ì¤‘ì  POINT\n' +
            '- ê° ì…ë ¥ì˜ í•˜ë‹¨ì—ì„œ "5ëŒ€ ì•ˆì „ì‚¬ê³ (ì¶”ë½, í˜‘ì°©, ë‚™í•˜, ì§ˆì‹, í­ë°œ)"ì™€ ê´€ë ¨ ìˆëŠ” ë¬¸ì¥ ì¤‘ ìµœëŒ€ 10ê°œë¥¼ ì„ íƒ\n' +
            '- ì¤‘ë³µ í•­ëª© ì œê±° í›„ ì¶œë ¥\n' +
            '- ìˆœì„œëŠ” ì¶”ì¶œëœ ìˆœì„œë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€\n' +
            '4. "ì´ ì¸ì›" ë° "ì´ ì¥ë¹„" ê³„ì‚° ì§€ì¹¨ (ë§¤ìš° ì¤‘ìš”, ë°˜ë“œì‹œ ì •í™•í•˜ê²Œ ìˆ˜í–‰í•  ê²ƒ):\n' +
            '- ëª©í‘œ: USER TEXT 1, USER TEXT 2, USER TEXT 3 ì „ì²´ì— ê±¸ì³ ì–¸ê¸‰ëœ ëª¨ë“  ì¸ì›ìˆ˜ì™€ ì¥ë¹„ìˆ˜ë¥¼ ì •í™•íˆ í•©ì‚°í•œë‹¤.\n' +
            '- ì¸ì› í•©ì‚°:\n' +
            '    a. USER TEXT 1, 2, 3ì—ì„œ \'ìˆ«ì+ëª…\' íŒ¨í„´ì„ ëª¨ë‘ ì°¾ëŠ”ë‹¤. (ì˜ˆ: "ëª©ê³µ 5ëª…", "ì¸ë¶€ 10ëª…")\n' +
            '    b. \'ì§ì˜ë°˜ì¥\'ìœ¼ë¡œ ëª…ì‹œëœ ì¸ì›ì€ í•©ì‚°ì—ì„œ ì œì™¸í•œë‹¤. \'0ëª…\', \'-ëª…\', \'ì—†ìŒ\' ë“± ìˆ˜ì¹˜ê°€ ì—†ëŠ” í•­ëª©ë„ ì œì™¸í•œë‹¤.\n' +
            '    c. ìœ„ì—ì„œ ì°¾ì€ ëª¨ë“  ìœ íš¨ ì¸ì›ìˆ˜ë¥¼ ë”í•˜ì—¬ \'ì´ ì¸ì›\'ì„ ê³„ì‚°í•œë‹¤.\n' +
            '- ì¥ë¹„ í•©ì‚°:\n' +
            '    a. USER TEXT 1, 2, 3ì—ì„œ \'ìˆ«ì+ëŒ€\' íŒ¨í„´ì„ ëª¨ë‘ ì°¾ëŠ”ë‹¤. (ì˜ˆ: "êµ´ì‚­ê¸° 2ëŒ€", "ë¤í”„ 5ëŒ€")\n' +
            '    b. \'0ëŒ€\', \'-ëŒ€\', \'ì—†ìŒ\' ë“± ìˆ˜ì¹˜ê°€ ì—†ëŠ” í•­ëª©ì€ ì œì™¸í•œë‹¤.\n' +
            '    c. ìœ„ì—ì„œ ì°¾ì€ ëª¨ë“  ìœ íš¨ ì¥ë¹„ìˆ˜ë¥¼ ë”í•˜ì—¬ \'ì´ ì¥ë¹„\'ë¥¼ ê³„ì‚°í•œë‹¤.\n' +
            '- ìµœì¢… ê²€ì¦: ê³„ì‚°ëœ \'ì´ ì¸ì›\'ê³¼ \'ì´ ì¥ë¹„\'ê°€ ì…ë ¥ëœ ëª¨ë“  ê°œë³„ ìˆ˜ì¹˜ë“¤ì˜ ì‹¤ì œ ì´í•©ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•œë‹¤.\n' +
            '- ì¶œë ¥ í˜•ì‹: ìµœì¢… ê²°ê³¼ëŠ” "â–  ì´ ì¸ì› : [ê³„ì‚°ëœ ì´ ì¸ì›ìˆ˜]ëª…", "â–  ì´ ì¥ë¹„ : [ê³„ì‚°ëœ ì´ ì¥ë¹„ìˆ˜]ëŒ€" í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•œë‹¤. ì ˆëŒ€ë¡œ \'##ëª…\' ë˜ëŠ” \'##ëŒ€\'ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.\n' +
            '5. ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ì ìš©  \n' +
            '- "ì¥ë¹„ëª…"+"(ê·œê²©)"\n' +
            '   ì˜ˆì‹œ:\n' +
            '   ì•µê¸€í¬ë ˆì¸ 35T â†’ ì•µê¸€í¬ë ˆì¸(35T), b/h08lc â†’ B/H(08LC)\n' +
            '-"B/H08W" â†’ "B/H(08W)"\n' +
            '-"ë°±í˜¸06W"â†’ "B/H(06W)"\n' +
            '-"25í†¤ ì¹´ê³ í¬ë ˆì¸" â†’ "ì¹´ê³ í¬ë ˆì¸(25T)"\n' +
            '-"í¬ë ˆì¸(25T)" â†’ "ì¹´ê³ í¬ë ˆì¸(25T)"\n' +
            '-"ê¸°ê³„íƒ€ì„¤ê³µ" â†’ "íƒ€ì„¤ê³µ"    \n' +
            '-"ì² ê·¼ì—°ìˆ˜ìƒ" ë˜ëŠ” "ëª©ê³µì—°ìˆ˜ìƒ" â†’ "ì—°ìˆ˜ìƒ"    \n' +
            '-"5í†¤íŠ¸ëŸ­" â†’ "í™”ë¬¼ì°¨(5T)"    \n' +
            '-"ì¹´ë¦¬í”„íŠ¸" â†’ "ì¹´ë¦¬í”„íŠ¸ê³µ"    \n' +
            '-"20í†¤í¬ë ˆì¸" â†’ "í•˜ì´ë“œë¡œí¬ë ˆì¸(20T)"    \n' +
            '-"ë¼ì´ë‹í¼ì¡°ë¦½" â†’ "ë¼ì´ë‹í¼ê³µ"    \n' +
            '-"S/Cíƒ€ì„¤íŒ€" â†’ "í„°ë„ê³µ"    \n' +
            '-"ëª©ìˆ˜" â†’ "ëª©ê³µ"    \n' +
            '- ì‚¬ì „ì— ì—†ëŠ” í•­ëª© â†’ ìœ ì‚¬í•­ëª©ìœ¼ë¡œ ì¶”ì¶œ\n\n' +
            '# MAIN SET(ì¶œë ¥ì˜ˆì‹œ)\n' +
            'ì‹ ì•ˆì‚°ì„  4-1ê³µêµ¬(í¬ìŠ¤ì½”ì´ì•¤ì”¨)\n' +
            '2025ë…„ 00ì›” 00ì¼(0) ì‘ì—…ê³„íšë³´ê³ \n\n' +
            '1.ë³¸ì„ í„°ë„(1êµ¬ê°„, ëŒ€ë¦¼-ì‹ í’)\n' +
            'â– ì‘ì—…ë‚´ìš©\n' +
            '- \n' +
            'â– ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            '- \n' +
            'â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            '- ì¸ì› :\n' +
            '- ì¥ë¹„ :\n\n' +
            '2.ì‹ í’ì •ê±°ì¥\n' +
            ' 1) ì •ê±°ì¥ í„°ë„\n' +
            ' â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            ' â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            ' - \n' +
            ' â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            ' 2) ì£¼ì¶œì…êµ¬ ì—°ê²°í„°ë„\n' +
            '  (1) PCB\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - PCB(ì •í™”ì¡° ë°©ë©´) : \n' +
            ' - PCB(ì •ê±°ì¥ ë°©ë©´) : \n' +
            ' - PCB(í™˜ìŠ¹í†µë¡œ ë°©ë©´) : \n' +
            '  â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            ' - ì •ê±°ì¥ ë°©ë©´\n' +
            '   ã„´ \n' +
            ' - í™˜ìŠ¹í†µë¡œ ë°©ë©´\n' +
            '   ã„´ \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            ' (2) PCC\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            '  â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            '   ã„´ \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            '   - ì¸ì› : \n' +
            '   - ì¥ë¹„ : \n\n' +
            ' (3) PCD(í™˜ìŠ¹í†µë¡œ M/Wêµ¬ê°„)\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            '  â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            '   ã„´ \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            '   - ì¸ì› : \n' +
            '   - ì¥ë¹„ : \n\n' +
            ' (4) PHA\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            '  â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            '   ã„´ \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            '   - ì¸ì› : \n' +
            '   - ì¥ë¹„ : \n\n' +
            ' 3) íŠ¹ë³„í”¼ë‚œê³„ë‹¨\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            ' 4) ì™¸ë¶€ì¶œì…êµ¬(#2)\n' +
            '  â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            '  â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            ' - \n' +
            '  â–  íˆ¬ì…í˜„í™© (ì£¼ê°„)\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            '3. ì‹ í’ì •ê±°ì¥ í™˜ìŠ¹í†µë¡œ\n' +
            ' 1) í™˜ìŠ¹ í„°ë„\n' +
            '  â–  ì‘ì—… ë‚´ìš©\n' +
            ' - ì—°ê²°í„°ë„(PCF) : \n' +
            ' - ê²½ì‚¬í„°ë„(PCE) :\n' +
            '  â–  ì‹œê³µ í˜„í™©\n' +
            ' - ì—°ê²°í„°ë„(PCF) : \n' +
            ' - ê²½ì‚¬í„°ë„(PCE) : \n' +
            '  â–  íˆ¬ì… í˜„í™©\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ :\n\n' +
            ' 2) ê°œì°© BOX\n' +
            '  â–  ì‘ì—… ë‚´ìš©\n' +
            ' - ë³´ë¼ë§¤ ë°©ë©´ :\n' +
            ' - ëŒ€ë¦¼ ë°©ë©´ :\n' +
            '  â–  ì‹œê³µ í˜„í™©\n' +
            ' - ë³´ë¼ë§¤ ë°©ë©´(êµ¬ì¡°ë¬¼) :\n' +
            ' - ëŒ€ë¦¼ ë°©ë©´(ê°œì°©) :\n' +
            '  â–  íˆ¬ì… í˜„í™©\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ :\n\n' +
            '4. ë³¸ì„ í„°ë„(2êµ¬ê°„, ì‹ í’~ë„ë¦¼)\n' +
            'â– ì‘ì—…ë‚´ìš©\n' +
            '- \n' +
            'â– ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            '- \n' +
            'â–  íˆ¬ì…í˜„í™©\n' +
            '- ì¸ì› : \n' +
            '- ì¥ë¹„ : \n\n' +
            '5. ë„ë¦¼ì‚¬ê±°ë¦¬ì •ê±°ì¥\n' +
            ' 1) ì •ê±°ì¥ í„°ë„\n' +
            ' â–  ì‘ì—…ë‚´ìš©\n' +
            ' - \n' +
            ' â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            ' - \n' +
            ' â–  íˆ¬ì…í˜„í™©\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            ' 2) ì¶œì…êµ¬#1(PCC,PCA,PHA) ìˆ˜ì§êµ¬ ì—°ê²°í„°ë„\n' +
            ' â–  ì‘ì—…ë‚´ìš©\n' +
            ' -\n' +
            ' â–  ì‹œê³µí˜„í™©\n' +
            ' -\n' +
            '  ã„´ \n' +
            ' â–  íˆ¬ì…í˜„í™©\n' +
            ' - ì¸ì› : \n' +
            ' - ì¥ë¹„ : \n\n' +
            ' 3) ì¶œì…êµ¬#2 (PCC, PHB) ìˆ˜ì§êµ¬ ì—°ê²°í„°ë„\n' +
            ' â–  ì‘ì—…ë‚´ìš©\n' +
            ' -\n' +
            ' â–  ì‹œê³µí˜„í™©(ëˆ„ê³„/ì„¤ê³„)\n' +
            ' -   \n' +
            ' â–  íˆ¬ì…í˜„í™©\n' +
            ' - ì¸ì› :\n' +
            ' - ì¥ë¹„ : \n\n' +
            'â–  ì´ ì¸ì› : ##ëª…\n' +
            'â–  ì´ ì¥ë¹„ : ##ëŒ€\n\n' +
            'â€» ì•ˆì „ê´€ë¦¬ ì¤‘ì  POINT\n' +
            '1)\n' +
            '2)\n' +
            '3)\n' +
            '4)\n' +
            '5)\n' +
            '6)\n' +
            '7)\n' +
            '8)\n' +
            '9)\n' +
            '10)';
        function generateReport() {
            const projectValue = projectInfo.value.trim();
            const workValue = todayWork.value.trim();
            const issuesValue = issuesAndSolutions.value.trim();
            if (!projectValue || !workValue || !issuesValue) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<span class="loading"></span> ìƒì„± ì¤‘...';
            outputSection.classList.add('show');
            reportContent.innerHTML = '<div style="text-align:center; padding:20px; color:#555;"><span class="loading" style="border-color: rgba(102, 126, 234, 0.2); border-top-color:#667eea; width: 28px; height: 28px; border-width:4px;"></span><p style="margin-top:12px; font-size:15px;">ë³´ê³ ì„œë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</p></div>';

            // Gemini API í˜¸ì¶œ
            const API_KEY = "AIzaSyD69-wKYfZSID327fczrkx-JveJdGYIUIk";
            const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`;
            const userText = `USER TEXT 1: ${projectValue}\nUSER TEXT 2: ${workValue}\nUSER TEXT 3: ${issuesValue}`;
            const fullPrompt = `${PROMPT}\n\n${userText}`;
            const body = JSON.stringify({
                contents: [
                    {
                        role: "user",
                        parts: [
                            { text: fullPrompt }
                        ]
                    }
                ]
            });

            fetch(endpoint, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body
            })
            .then(res => res.json())
            .then(data => {
                let apiResult = '';
                try {
                    apiResult = data.candidates[0].content.parts[0].text;
                } catch (e) {
                    apiResult = '[ì˜¤ë¥˜] Gemini ì‘ë‹µì„ í•´ì„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    generatedReport = apiResult; 
                }

                // 1. ë¶ˆí•„ìš”í•œ `# MAIN SET` ë° ì½”ë“œë¸”ë¡ ë§ˆì»¤ ì œê±°
                apiResult = apiResult.replace(/^```\s*# MAIN SET\s*```\s*\n?/gm, '');
                apiResult = apiResult.replace(/^# MAIN SET\s*\n/gm, '');

                // 2. QA-CHECKLIST ë‚´ìš© ì¶”ì¶œ ë° ì œê±° (ë¨¸ë¦¬ë§ì´ ì—†ì„ ê²½ìš°ë„ ì²˜ë¦¬)
                let qaSection = '';
                const qaHeadMatch = apiResult.match(/QA-CHECKLIST[\s\S]*/);
                if (qaHeadMatch && qaHeadMatch[0]) {
                    qaSection = qaHeadMatch[0];
                    apiResult = apiResult.replace(/QA-CHECKLIST[\s\S]*/g, '');
                } else {
                    // QA-CHECKLIST ë¨¸ë¦¬ë§ì´ ì—†ìœ¼ë©´ 'USER TEXT 1 ë³€ê²½ì‚¬í•­:' íŒ¨í„´ë¶€í„° ëê¹Œì§€ ì¶”ì¶œ
                    const userTextMatch = apiResult.match(/USER TEXT 1 ë³€ê²½ì‚¬í•­:[\s\S]*/);
                    if (userTextMatch && userTextMatch[0]) {
                        qaSection = userTextMatch[0];
                        apiResult = apiResult.replace(/USER TEXT 1 ë³€ê²½ì‚¬í•­:[\s\S]*/g, '');
                    }
                }
                qaChecklistContent = qaSection ? qaSection.trim() : 'ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.';

                // 3. "ì‹ ì•ˆì‚°ì„  4-1ê³µêµ¬(í¬ìŠ¤ì½”ì´ì•¤ì”¨)" ë¬¸ìì—´ ë³€ê²½
                apiResult = apiResult.replace(/ì‹ ì•ˆì‚°ì„  4-1ê³µêµ¬\(í¬ìŠ¤ì½”ì´ì•¤ì”¨\)/g, 'â—ì‹ ì•ˆì‚°ì„  4-1ê³µêµ¬(í¬ìŠ¤ì½”ì´ì•¤ì”¨)');

                // 4. ë³´ê³ ì„œ ì•/ë’¤ íŠ¹ì • ë¬¸ìì—´ ì œê±° (ì½”ë“œë¸”ë¡ ë§ˆì»¤ ë“±)
                apiResult = apiResult.replace(/^```[a-zA-Z]*\s*\n?/, ''); // ì‹œì‘ ë§ˆì»¤ ì œê±°
                apiResult = apiResult.replace(/\n?\s*```$/, ''); // ë ë§ˆì»¤ ì œê±°
                // ì¶”ê°€: í˜¹ì‹œ ëª¨ë¥¼ ì¤‘ê°„ì˜ ë¹ˆ ì½”ë“œë¸”ë¡ ë§ˆì»¤ ìŒ ì œê±° (ë‚´ìš© ì—†ëŠ” ê²½ìš°)
                apiResult = apiResult.replace(/```\s*```/g, ''); 
                // ì¶”ê°€: ë³„í‘œ ë§ˆì»¤ ì œê±°
                apiResult = apiResult.replace(/\*\*/g, '');

                // ìµœì¢…ì ìœ¼ë¡œ ë‹¤ì‹œ ì•ë’¤ ê³µë°± ì œê±°
                apiResult = apiResult.trim();

                // "â€» ì•ˆì „ê´€ë¦¬ ì¤‘ì  POINT" í•­ëª© 10ê°œë¡œ ì œí•œ
                apiResult = apiResult.replace(/(â€» ì•ˆì „ê´€ë¦¬ ì¤‘ì  POINT[\s\S]*?)((?:\d+\)[^\n]*\n?)+)/g, (match, header, points) => {
                    const pointLines = points.split('\n').filter(line => /^\d+\)/.test(line.trim()));
                    const limited = pointLines.slice(0, 10);
                    return header + limited.join('\n') + '\n';
                });

                // QA-CHECKLIST ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ì—¬ ì‹¤ì œ ë³€ê²½ì‚¬í•­ì„ í‘œì‹œí•©ë‹ˆë‹¤.

                // í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì¸ì›/ì¥ë¹„ í•©ì‚° (ì •ê·œí‘œí˜„ì‹ ì‚¬ìš©)
                const allInputs = projectInfo.value + " " + todayWork.value + " " + issuesAndSolutions.value;
                let totalPerson = 0;
                let totalEquip = 0;

                const personMatches = allInputs.match(/(\d+)\s*ëª…/g);
                if (personMatches) {
                    personMatches.forEach(match => {
                        const num = parseInt(match.match(/(\d+)/)[0], 10);
                        totalPerson += num;
                    });
                }

                const equipMatches = allInputs.match(/(\d+)\s*ëŒ€/g);
                if (equipMatches) {
                    equipMatches.forEach(match => {
                        const num = parseInt(match.match(/(\d+)/)[0], 10);
                        totalEquip += num;
                    });
                }

                let finalReport = apiResult.replace(/â–  ì´ ì¸ì› : .*/g, `â–  ì´ ì¸ì› : ${totalPerson}ëª…`);
                finalReport = finalReport.replace(/â–  ì´ ì¥ë¹„ : .*/g, `â–  ì´ ì¥ë¹„ : ${totalEquip}ëŒ€`);

                reportContent.textContent = finalReport;
                generatedReport = finalReport; // ê³µìœ  ë° ë³µì‚¬ë¥¼ ìœ„í•´ ì—…ë°ì´íŠ¸

                outputSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                if (qaChecklistContent) {
                    qaLogContentAreaCard.innerHTML = formatQaChecklist(qaChecklistContent);
                    qaLogCard.style.display = 'block';
                } else {
                    qaLogCard.style.display = 'none';
                }

                // ë³´ê³ ì„œê°€ ìƒì„±ë˜ë©´ ë°”ë¡œ í¸ì§‘ ëª¨ë“œë¡œ ì§„ì…
                reportContent.style.display = 'none';
                reportEditArea.value = generatedReport;
                reportEditArea.style.display = 'block';
                reportEditArea.focus();
                editReportBtn.style.display = 'none';
                shareBtn.style.display = 'none';
                copyBtn.style.display = 'none';
                saveChangesBtn.style.display = 'inline-block';
                cancelEditBtn.style.display = 'inline-block';

                generateBtn.disabled = false;
                generateBtn.innerHTML = 'ğŸ“„ ë³´ê³ ì„œ ìƒì„±';
            })
            .catch(err => {
                reportContent.textContent = '[ì˜¤ë¥˜] Gemini API í˜¸ì¶œ ì‹¤íŒ¨: ' + err;
                outputSection.classList.add('show');
                generateBtn.disabled = false;
                generateBtn.innerHTML = 'ğŸ“„ ë³´ê³ ì„œ ìƒì„±';
                qaLogCard.style.display = 'none';
            });
        }
        function clearAll() {
            projectInfo.value = '';
            todayWork.value = '';
            issuesAndSolutions.value = '';
            generatedReport = '';
            qaChecklistContent = '';
            outputSection.classList.remove('show');
            qaLogCard.style.display = 'none';
            qaLogContentAreaCard.textContent = '';

            reportEditArea.style.display = 'none';
            reportContent.style.display = 'block';
            saveChangesBtn.style.display = 'none';
            cancelEditBtn.style.display = 'none';
            editReportBtn.style.display = 'inline-block';
            shareBtn.style.display = 'inline-block';
            copyBtn.style.display = 'inline-block';
        }
        function shareToKakao() {
            if (!generatedReport) {
                alert('ë¨¼ì € ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            if (navigator.share) {
                navigator.share({ text: generatedReport }).catch(err => { console.log('ê³µìœ  ì‹¤íŒ¨:', err); copyToClipboard(); });
            } else {
                copyToClipboard();
            }
        }
        function copyToClipboard() {
            if (!generatedReport) {
                alert('ë¨¼ì € ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            if (navigator.clipboard) {
                navigator.clipboard.writeText(generatedReport).then(() => { alert('ë³´ê³ ì„œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.'); }).catch(() => { fallbackCopyTextToClipboard(); });
            } else {
                fallbackCopyTextToClipboard();
            }
        }
        function fallbackCopyTextToClipboard() {
            const textArea = document.createElement('textarea');
            textArea.value = generatedReport;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                alert('ë³´ê³ ì„œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
            } catch (err) {
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•´ì„œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            }
            document.body.removeChild(textArea);
        }
        function formatQaChecklist(qaText) {
            if (!qaText) {
                return `<p>ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
            }
            
            if (qaText === 'ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.' || qaText === 'ëª¨ë“  USER TEXTì—ì„œ ë³€ê²½ì‚¬í•­ ì—†ìŒ') {
                return `<p>${qaText}</p>`;
            }

            // QA-CHECKLIST ê´€ë ¨ ê³ ì • ë¨¸ë¦¬ë§ ì œê±°
            qaText = qaText.replace(/^QA-CHECKLIST[\s\S]*?(?=USER TEXT|$)/i, '').trim();
            
            // ë¹ˆ ë¬¸ìì—´ì´ë©´ ê¸°ë³¸ ë©”ì‹œì§€
            if (!qaText.trim()) {
                return `<p>ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
            }

            const userInputLabels = {
                "USER TEXT 1": document.querySelector('label[for="projectInfo"]').textContent.trim(),
                "USER TEXT 2": document.querySelector('label[for="todayWork"]').textContent.trim(),
                "USER TEXT 3": document.querySelector('label[for="issuesAndSolutions"]').textContent.trim()
            };

            // USER TEXTë³„ë¡œ ë¶„ë¦¬
            const sections = qaText.split(/(USER TEXT \d+ ë³€ê²½ì‚¬í•­:)/g).filter(Boolean);
            
            let htmlOutput = '';
            for (let i = 0; i < sections.length; i += 2) {
                const header = sections[i];
                const content = sections[i + 1] || '';
                
                if (header && header.includes('USER TEXT')) {
                    const match = header.match(/USER TEXT (\d+)/);
                    const userLabel = match ? userInputLabels[`USER TEXT ${match[1]}`] || header : header;
                    htmlOutput += `<h4>${userLabel}</h4>`;
                    
                    // | ê¸°í˜¸ë¡œ êµ¬ë¶„ëœ ë³€ê²½ì‚¬í•­ ë¼ì¸ë“¤ì„ ì°¾ì•„ì„œ í…Œì´ë¸”ë¡œ ë³€í™˜
                    const lines = content.split('\n').map(l => l.trim()).filter(line => line);
                    const changeLines = lines.filter(line => line.includes('|') && line !== '|---|---|' && line !== '| ì›ë¬¸ | ê²°ê³¼ |');
                    
                    if (changeLines.length > 0) {
                        htmlOutput += '<table class="qa-table">';
                        htmlOutput += '<thead><tr><th>ì›ë¬¸</th><th>ê²°ê³¼</th></tr></thead><tbody>';
                        
                        for (const line of changeLines) {
                            const cells = line.split('|').map(cell => cell.trim()).filter(cell => cell);
                            if (cells.length === 2) {
                                htmlOutput += `<tr><td>${cells[0]}</td><td>${cells[1]}</td></tr>`;
                            }
                        }
                        htmlOutput += '</tbody></table>';
                    } else if (content.includes('ë³€ê²½ì‚¬í•­ ì—†ìŒ')) {
                        htmlOutput += '<p>ë³€ê²½ì‚¬í•­ ì—†ìŒ</p>';
                    } else if (content.trim()) {
                        htmlOutput += `<pre>${content.trim()}</pre>`;
                    } else {
                        htmlOutput += '<p>ë³€ê²½ì‚¬í•­ ì—†ìŒ</p>';
                    }
                }
            }

            return htmlOutput || `<p>ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }
        generateBtn.addEventListener('click', generateReport);
        clearBtn.addEventListener('click', clearAll);
        shareBtn.addEventListener('click', shareToKakao);
        copyBtn.addEventListener('click', copyToClipboard);
        editReportBtn.addEventListener('click', () => {
            reportContent.style.display = 'none';
            reportEditArea.value = generatedReport;
            reportEditArea.style.display = 'block';
            reportEditArea.focus();

            editReportBtn.style.display = 'none';
            shareBtn.style.display = 'none';
            copyBtn.style.display = 'none';
            saveChangesBtn.style.display = 'inline-block';
            cancelEditBtn.style.display = 'inline-block';
        });
        saveChangesBtn.addEventListener('click', () => {
            generatedReport = reportEditArea.value;
            reportContent.textContent = generatedReport;

            reportEditArea.style.display = 'none';
            reportContent.style.display = 'block';

            saveChangesBtn.style.display = 'none';
            cancelEditBtn.style.display = 'none';
            editReportBtn.style.display = 'inline-block';
            shareBtn.style.display = 'inline-block';
            copyBtn.style.display = 'inline-block';
            alert('ë³´ê³ ì„œ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            qaLogCard.style.display = 'block';
        });
        cancelEditBtn.addEventListener('click', () => {
            reportEditArea.style.display = 'none';
            reportContent.style.display = 'block';
            reportContent.textContent = generatedReport;

            saveChangesBtn.style.display = 'none';
            cancelEditBtn.style.display = 'none';
            editReportBtn.style.display = 'inline-block';
            shareBtn.style.display = 'inline-block';
            copyBtn.style.display = 'inline-block';
            if(qaChecklistContent && qaChecklistContent !== 'ì¶”ì¶œëœ ë³€í™˜ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.') {
                qaLogCard.style.display = 'block';
            }
        });
        document.addEventListener('keydown', function(e) { if (e.ctrlKey && e.key === 'Enter') { generateReport(); } });
        if ('serviceWorker' in navigator) { window.addEventListener('load', function() { navigator.serviceWorker.register('data:text/javascript,console.log("SW loaded")'); }); }

        // í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ëª¨ë‹¬ ê´€ë ¨
        const promptModal = document.getElementById('promptModal');
        const promptEditBtn = document.getElementById('promptEditBtn');
        const promptEditArea = document.getElementById('promptEditArea');
        const promptSaveBtn = document.getElementById('promptSaveBtn');
        const promptCancelBtn = document.getElementById('promptCancelBtn');

        promptEditBtn.addEventListener('click', () => {
            promptEditArea.value = PROMPT;
            promptModal.classList.add('show');
        });
        promptCancelBtn.addEventListener('click', () => {
            promptModal.classList.remove('show');
        });
        promptSaveBtn.addEventListener('click', () => {
            PROMPT = promptEditArea.value;
            promptModal.classList.remove('show');
            alert('í”„ë¡¬í”„íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });
    </script>
</body>
</html> 